{"version":3,"sources":["webpack://faq/./src/pages/sorteio.tsx"],"names":["Content","participants","group","showFriendOnClick","className","name","comments","onClick","participant","current","others","map","index","key","React","loading","state","setState","showPopup","setShowPopup","query","URLSearchParams","window","location","search","groupId","get","personId","fetch","process","then","response","json","data","message","reduce","acc","newMap","push","alert","catch","friend","action","open","action2"],"mappings":"wIAmBMA,EAAU,SAAC,GAAgD,IAA9CC,EAA6C,EAA7CA,aAAcC,EAA+B,EAA/BA,MAAOC,EAAwB,EAAxBA,kBACtC,OACE,gCACE,2BACE,2BAASC,UAAU,aACjB,sBAAIA,UAAU,sBAAsBF,EAAMG,MAC1C,yBAAIH,EAAMI,UAEV,0BACEF,UAAU,wEACVG,QAASJ,GAFX,iDAQF,2BAASC,UAAU,aACjB,uBAAKA,UAAU,OACb,gBAAC,KAAD,CAAiBI,YAAaP,EAAaQ,UAC1CR,EAAaS,OAAOC,KAAI,SAACH,EAAaI,GAAd,OACvB,gBAAC,KAAD,CAAaC,IAAKD,EAAOJ,YAAaA,YA0GpD,UAlG8B,WAC5B,IAGA,EAA0BM,WAHE,CAC1BC,SAAS,IAEJC,EAAP,KAAcC,EAAd,KAEA,EAAkCH,YAAe,GAA1CI,EAAP,KAAkBC,EAAlB,KA+DA,OAjDAL,aAAgB,WACd,IAAMM,EAAQ,IAAIC,gBAAgBC,OAAOC,SAASC,QAC5CC,EAAUL,EAAMM,IAAI,KACpBC,EAAWP,EAAMM,IAAI,KAE3BE,MAASC,0EAA2CJ,EAA/C,IAA0DE,GAC5DG,MAAK,SAACC,GAAD,OAAcA,EAASC,UAC5BF,MAAK,SAACG,GACL,GAAqB,oBAAjBA,EAAKC,QAKF,GAAqB,KAAjBD,EAAKC,QAAT,CAOP,IAAMjC,EAAegC,EAAKhC,aAAakC,QAAO,SAACC,EAAK5B,GAClD,IAAM6B,EAASD,EAWf,OAVI5B,EAAYC,QACd4B,EAAM,QAAN,iBACK7B,EADL,CAEEiB,YAEOY,EAAM,OACfA,EAAM,OAAWC,KAAK9B,GAEtB6B,EAAM,OAAa,CAAC7B,GAEf6B,IACN,IAEHpB,EAAS,CACPF,SAAS,EACTd,eACAC,MAAO,CAAEG,KAAM4B,EAAK5B,KAAMC,SAAU2B,EAAK3B,YAE3Ca,GAAa,QA1BXoB,MACE,mJANFA,MACE,2QAgCLC,OAAM,WACLD,MACE,qIAGL,EAAC,IAGF,gCACE,gBAAC,KAAD,KACE,gBAAC,IAAD,KACE,wDAGDvB,EAAMD,QACL,gBAAC,KAAD,MAEA,gBAACf,EAAD,CACEG,kBAxEqB,WAC7BgB,GAAa,IAwELjB,MAAOc,EAAMd,MACbD,aAAce,EAAMf,eAIvBiB,GACC,gBAAC,KAAD,CACEgB,QAAO,eAAiBlB,EAAMf,aAAaQ,QAAQgC,OAA5C,OACPC,OA7EQ,WAChBpB,OAAOqB,KAAK,uCA6EJC,QA1ES,WACjBzB,GAAa","file":"component---src-pages-sorteio-tsx-c8fe6464296fbe84cb09.js","sourcesContent":["import * as React from \"react\"\nimport { Helmet } from \"react-helmet\"\nimport {\n  Layout,\n  LoadingScreen,\n  Participant,\n  ParticipantForm,\n  Popup,\n} from \"../components\"\n\ninterface State {\n  loading: boolean\n  participants?: any\n  group?: {\n    name: string\n    comments: string\n  }\n}\n\nconst Content = ({ participants, group, showFriendOnClick }) => {\n  return (\n    <>\n      <div>\n        <section className=\"px-5 pt-4\">\n          <h2 className=\"font-weight-bolder\">{group.name}</h2>\n          <p>{group.comments}</p>\n\n          <button\n            className=\"gradient-bg border-0 rounded-lg py-3 px-4 text-white font-weight-bold\"\n            onClick={showFriendOnClick}\n          >\n            Clique aqui para descobrir seu amigo secreto\n          </button>\n        </section>\n\n        <section className=\"px-5 pt-4\">\n          <div className=\"row\">\n            <ParticipantForm participant={participants.current} />\n            {participants.others.map((participant, index) => (\n              <Participant key={index} participant={participant} />\n            ))}\n          </div>\n        </section>\n      </div>\n    </>\n  )\n}\nconst SorteioPage: React.FC = () => {\n  const initialState: State = {\n    loading: true,\n  }\n  const [state, setState] = React.useState(initialState)\n\n  const [showPopup, setShowPopup] = React.useState(false)\n\n  const showFriend: () => void = () => {\n    setShowPopup(true)\n  }\n\n  const openStore = () => {\n    window.open(\"https://www.papelzinho.com.br/loja\")\n  }\n\n  const hideFriend = () => {\n    setShowPopup(false)\n  }\n\n  React.useEffect(() => {\n    const query = new URLSearchParams(window.location.search)\n    const groupId = query.get(\"g\")\n    const personId = query.get(\"p\")\n\n    fetch(`${process.env.GATSBY_API_HOST}/participant/${groupId}/${personId}`)\n      .then((response) => response.json())\n      .then((data) => {\n        if (data.message === \"Group not found\") {\n          alert(\n            \"Aparentemente o seu grupo de amigo secreto foi deletado pelo organizador no app. Caso esta mensagem esteja errada e seu grupo n√£o tenha sido exclu√≠do, entre em contato com o suporte atrav√©s do meajuda@papelzinho.com.br ou pelo chat na nossa p√°gina do facebook.\"\n          )\n          return\n        } else if (data.message === \"\") {\n          alert(\n            \"Participante n√£o encontrado. Entre em contato com o suporte atrav√©s do meajuda@papelzinho.com.br ou pelo chat na nossa p√°gina do facebook.\"\n          )\n          return\n        }\n\n        const participants = data.participants.reduce((acc, participant) => {\n          const newMap = acc\n          if (participant.current) {\n            newMap[\"current\"] = {\n              ...participant,\n              groupId,\n            }\n          } else if (newMap[\"others\"]) {\n            newMap[\"others\"].push(participant)\n          } else {\n            newMap[\"others\"] = [participant]\n          }\n          return newMap\n        }, {})\n\n        setState({\n          loading: false,\n          participants,\n          group: { name: data.name, comments: data.comments },\n        })\n        setShowPopup(true)\n      })\n      .catch(() => {\n        alert(\n          \"Sistema fora do ar. Estamos trabalhando para corrigir o problema o mais r√°pido poss√≠vel. Tente acessar novamente mais tarde.\"\n        )\n      })\n  }, [false])\n\n  return (\n    <>\n      <Layout>\n        <Helmet>\n          <title>Sorteio | Papelzinho ‚Ñ¢</title>\n        </Helmet>\n\n        {state.loading ? (\n          <LoadingScreen />\n        ) : (\n          <Content\n            showFriendOnClick={showFriend}\n            group={state.group}\n            participants={state.participants}\n          />\n        )}\n\n        {showPopup && (\n          <Popup\n            message={`Voc√™ tirou \"${state.participants.current.friend}\" üéâ`}\n            action={openStore}\n            action2={hideFriend}\n          />\n        )}\n      </Layout>\n    </>\n  )\n}\n\nexport default SorteioPage\n"],"sourceRoot":""}